# Hotel Booking Cancellation Prediction

![Python](https://img.shields.io/badge/Python-3.10%2B-blue)
![Scikit-Learn](https://img.shields.io/badge/Library-Scikit--Learn-orange)
![SHAP](https://img.shields.io/badge/XAI-SHAP-green)
![Status](https://img.shields.io/badge/Status-Completed-brightgreen)

## –û –ø—Ä–æ–µ–∫—Ç–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø–æ—Å–≤—è—â–µ–Ω —Ä–µ—à–µ–Ω–∏—é –∑–∞–¥–∞—á–∏ –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏: –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—é –æ—Ç–º–µ–Ω—ã –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–µ–ª—è (`is_canceled`).

–î–ª—è –æ—Ç–µ–ª—å–Ω–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞ –æ—Ç–º–µ–Ω—ã ‚Äî —ç—Ç–æ –ø–æ—Ç–µ—Ä—è –≤—ã—Ä—É—á–∫–∏ –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø–µ—Ä—Å–æ–Ω–∞–ª–∞.
**–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞:** –†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å ML-—Ä–µ—à–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–º–æ–∂–µ—Ç –±–∏–∑–Ω–µ—Å—É –∑–∞—Ä–∞–Ω–µ–µ –≤—ã—è–≤–ª—è—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å –≤—ã—Å–æ–∫–∏–º —Ä–∏—Å–∫–æ–º –æ—Ç–º–µ–Ω—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –æ–≤–µ—Ä–±—É–∫–∏–Ω–≥–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Ö–æ–¥–∞–º–∏ (Revenue Management).

–ü—Ä–æ–µ–∫—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –≤ —Ä–∞–º–∫–∞—Ö –∫—É—Ä—Å–∞ –ø–æ Machine Learning –∏ –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏: –æ—Ç —Ä–∞–∑–≤–µ–¥–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –º–æ–¥–µ–ª–∏.

---

## –î–∞–Ω–Ω—ã–µ

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–∞—Ç–∞—Å–µ—Ç **Hotel Booking Demand**.
üîó **–ò—Å—Ç–æ—á–Ω–∏–∫:** [Kaggle: Hotel Booking Demand](https://www.kaggle.com/datasets/jessemostipak/hotel-booking-demand/)

**–†–∞–∑–º–µ—Ä:** ~119 000 –∑–∞–ø–∏—Å–µ–π.
**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:**
*   –î–∞—Ç–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∑–∞–µ–∑–¥–∞, `lead_time`.
*   –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –≥–æ—Å—Ç–µ–π (—Å—Ç—Ä–∞–Ω–∞, –≤–∑—Ä–æ—Å–ª—ã–µ/–¥–µ—Ç–∏).
*   –î–µ—Ç–∞–ª–∏ –±—Ä–æ–Ω–∏ (–¥–µ–ø–æ–∑–∏—Ç, —Ç–∏–ø –ø–∏—Ç–∞–Ω–∏—è, –ø–∞—Ä–∫–æ–≤–∫–∞, —Å–ø–µ—Ü. –∑–∞–ø—Ä–æ—Å—ã).

---

## –≠—Ç–∞–ø—ã —Ä–∞–±–æ—Ç—ã –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º

–†–∞–±–æ—Ç–∞ —Å—Ç—Ä–æ–∏–ª–∞—Å—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–æ –≥–ª—É–±–æ–∫–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:

### 1. –†–∞–∑–≤–µ–¥–æ—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (EDA) –∏ –ë–µ–π–∑–ª–∞–π–Ω
*   –ü—Ä–æ–≤–µ–¥–µ–Ω –ø–µ—Ä–≤–∏—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π.
*   –í—ã—è–≤–ª–µ–Ω –¥–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ (~37% –æ—Ç–º–µ–Ω) –∏ –∫–ª—é—á–µ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–≤–ª–∏—è–Ω–∏–µ `lead_time`, `deposit_type`, `total_of_special_requests`).
*   –ü–æ—Å—Ç—Ä–æ–µ–Ω **Baseline** –Ω–∞ –æ—Å–Ω–æ–≤–µ Logistic Regression –∏ Random Forest.
*   *–†–µ–∑—É–ª—å—Ç–∞—Ç —ç—Ç–∞–ø–∞:* Random Forest –ø–æ–∫–∞–∑–∞–ª –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (ROC-AUC > 0.95), –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–≤ –Ω–∞–ª–∏—á–∏–µ –Ω–µ–ª–∏–Ω–µ–π–Ω—ã—Ö —Å–≤—è–∑–µ–π.

### 2. –†–∞–±–æ—Ç–∞ —Å –∞–Ω–æ–º–∞–ª–∏—è–º–∏
*   –ü—Ä–∏–º–µ–Ω–µ–Ω—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã (IQR, Z-score) –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ —è–≤–Ω—ã—Ö –æ—à–∏–±–æ–∫ –¥–∞–Ω–Ω—ã—Ö.
*   –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã ML-–º–µ—Ç–æ–¥—ã (**Isolation Forest**, **OneClassSVM**) –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö –≤—ã–±—Ä–æ—Å–æ–≤.
*   *–†–µ—à–µ–Ω–∏–µ:* –ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–µ –∞–Ω–æ–º–∞–ª–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–µ–¥–∫–∏–µ –≥—Ä—É–ø–ø–æ–≤—ã–µ –∑–∞–µ–∑–¥—ã) –±—ã–ª–∏ —Ä–∞–∑–º–µ—á–µ–Ω—ã —Ñ–ª–∞–≥–∞–º–∏, –∞ –Ω–µ —É–¥–∞–ª–µ–Ω—ã, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ–ª–µ–∑–Ω—ã–π —Å–∏–≥–Ω–∞–ª –¥–ª—è –º–æ–¥–µ–ª–∏.

### 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (Feature Engineering)
*   **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:** –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç —á–µ—Ä–µ–∑ Sin/Cos –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è (—Ü–∏–∫–ª–∏—á–Ω–æ—Å—Ç—å).
*   **–ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Target Encoding —Å –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π.
*   **–ê–≥—Ä–µ–≥–∞—Ü–∏–∏:** –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ `adr_per_person` (—Ü–µ–Ω–∞ –Ω–∞ —á–µ–ª–æ–≤–µ–∫–∞), `total_nights`, `cancellation_ratio`.
*   *–†–µ–∑—É–ª—å—Ç–∞—Ç:* –†–æ—Å—Ç Precision –º–æ–¥–µ–ª–∏ –∏ —Å–Ω–∏–∂–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π.

### 4. –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (XAI)
*–í–∞–∂–Ω–æ–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ:* –ò–∑-–∑–∞ –≤—ã—Å–æ–∫–æ–π –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –º–µ—Ç–æ–¥–æ–≤ (–æ—Å–æ–±–µ–Ω–Ω–æ Shapley values –¥–ª—è –¥–µ—Ä–µ–≤—å–µ–≤) –¥–∞–Ω–Ω—ã–π —ç—Ç–∞–ø –ø—Ä–æ–≤–æ–¥–∏–ª—Å—è –Ω–∞ —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω–æ–π **–ø–æ–¥–≤—ã–±–æ—Ä–∫–µ –¥–∞–Ω–Ω—ã—Ö** (subsample).

*   **–ì–ª–æ–±–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è (SHAP/LIME):** –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–ø-—Ñ–∞–∫—Ç–æ—Ä–æ–≤ –≤–ª–∏—è–Ω–∏—è (–°—Ç—Ä–∞–Ω–∞, –î–µ–ø–æ–∑–∏—Ç, Lead Time).
*   **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è:**
    *   –ü–æ—Å—Ç—Ä–æ–µ–Ω—ã SHAP-—ç–º–±–µ–¥–¥–∏–Ω–≥–∏.
    *   –ü—Ä–æ–≤–µ–¥–µ–Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è (K-Means) –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ SHAP, –≤—ã—è–≤–∏–≤—à–∞—è —Å–∫—Ä—ã—Ç—ã–µ –≥—Ä—É–ø–ø—ã —Ä–∏—Å–∫–∞.
    *   –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–∞ –∫–∞–∫ —Ñ–∏—á–∏ –¥–∞–ª–æ –ø—Ä–∏—Ä–æ—Å—Ç –º–µ—Ç—Ä–∏–∫.
*   **Shapley Flow:** –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –ø–æ –æ–±—É—á–µ–Ω–∏—é –º–æ–¥–µ–ª–∏ –Ω–∞ "–æ–±—ä—è—Å–Ω–µ–Ω–∏—è—Ö" (SHAP values) –≤–º–µ—Å—Ç–æ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–∫–∞–∑–∞–ª –ª—É—á—à—É—é –æ–±–æ–±—â–∞—é—â—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å.

---

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ Google Colab.

1.  –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
    ```bash
    git clone https://github.com/happyqt/hotel-booking-prediction.git
    ```
2.  –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (–æ—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏):
    ```bash
    pip install pandas numpy scikit-learn matplotlib seaborn shap lime category_encoders
    ```
3.  –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –Ω–æ—É—Ç–±—É–∫–∞: `ML_project.ipynb`

---

## –ö–æ–º–∞–Ω–¥–∞ –ø—Ä–æ–µ–∫—Ç–∞

*   **–ê—Ö–º–µ—Ç–æ–≤ –¢–∏–º—É—Ä** ‚Äî –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –±–µ–π–∑–ª–∞–π–Ω–∞
*   **–ë–æ—Ä–∏—Å–æ–≤ –ê–ª–µ–∫—Å–µ–π** ‚Äî –†–∞–±–æ—Ç–∞ —Å –∞–Ω–æ–º–∞–ª—è–º–∏ –≤ –¥–∞–Ω–Ω—ã—Ö –∏ –∏—Ö –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è
*   **–°–æ–ª–æ–≤–µ–π –ê–ª–µ–∫—Å–∞–Ω–¥—Ä** ‚Äî –û—Ç–±–æ—Ä –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
*   **–ö–µ—Ä–∏–º–æ–≤ –ú–∏–∫–∞—ç–ª** ‚Äî –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –º–æ–¥–µ–ª–µ–π (SHAP, Clustering, Shapley Flow), –∞–Ω–∞–ª–∏–∑ —Å–¥–≤–∏–≥–æ–≤ –¥–∞–Ω–Ω—ã—Ö.

---
